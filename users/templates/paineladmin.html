{% extends 'userbase.html' %}
{% block content %}

  <div class="mb-4" style="padding: 2rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); background: #fff;">
    <button class="sidebar-toggle me-3" id="sidebarToggle"><i class="bi bi-list"></i></button>
    <h3 class="mb-1 {% if not identidade_visual.cor_principal %}text-dark{% endif %}" {% if identidade_visual.cor_principal %} style="color: {{ identidade_visual.cor_principal }} {% endif %}">Olá, {{ user.username }}!</h3>
    <p class="text-muted">Bem-vindo(a) à sua Área Pessoal!</p>
  </div>

  <div class="row mb-4">
  
  {% if user.is_staff or user.is_superuser %}
  <div class="col-12 mb-4">
      <div class="dashboard-card shadow-lg p-0">
        <div class="card-header text-white p-3 rounded-top w-100 {% if not identidade_visual.cor_principal %}bg-dark{% endif %}" {% if identidade_visual.cor_principal %} style="background-color: {{ identidade_visual.cor_principal }} {% endif %}">
          <h5 class="mb-0"><i class="bi bi-gear me-2"></i>Painel Administrativo</h5>
        </div>
        
        <div class="card-body p-4 bg-white rounded-bottom">
          <p class="mb-4">Gerencie os principais aspectos do site através dos atalhos abaixo:</p>
          
          <div class="row g-3">
             <div class="col-md-4">
                <a href="{% url 'editar_textos' %}" class="btn btn-outline-primary w-100 py-3 fw-bold">
                    <i class="bi bi-pencil-square fs-4 d-block mb-2"></i>
                    Editar Textos do Site
                </a>
             </div>

             <div class="col-md-4">
                <a href="{% url 'gerenciar_livro' %}" class="btn btn-outline-success w-100 py-3 fw-bold">
                    <i class="bi bi-book fs-4 d-block mb-2"></i>
                    Editar/Criar Livro
                </a>
             </div>

             <div class="col-md-4">
                <a href="{% url 'imageform' %}" class="btn btn-outline-info w-100 py-3 fw-bold">
                    <i class="bi bi-images fs-4 d-block mb-2"></i>
                    Gerenciar Carrossel
                </a>
             </div>
             
             {% if livro_id %} 
             <div class="col-12 mt-3 text-end border-top pt-3">
                <small class="text-muted me-2">Zona de Perigo:</small>
                <a href="{% url 'deletar_livro' livro_id %}" class="btn btn-danger btn-sm" onclick="return confirm('ATENÇÃO: Isso apagará o livro e todas as páginas permanentemente. Deseja continuar?');">
                    <i class="bi bi-trash"></i> Deletar Livro Atual
                </a>
             </div>
             {% endif %}
          </div>
        </div>
      </div>
  </div>
  {% endif %}

    <div class="col-md-6 mb-4">
      <div class="card border-primary h-100 shadow-sm">
        <div class="card-header bg-primary text-white">
          <h5 class="mb-0"><i class="bi bi-person-badge me-2"></i>Seu Perfil de Acesso</h5>
        </div>
        <div class="card-body">
          <div class="d-flex align-items-center mb-3">
            <div class="rounded-circle bg-light p-3 me-3">
              {% if user.is_staff or user.is_superuser %}
                <i class="bi bi-shield-check text-success" style="font-size: 1.5rem;"></i>
              {% else %}
                <i class="bi bi-person text-info" style="font-size: 1.5rem;"></i>
              {% endif %}
            </div>
            <div>
              <h6 class="mb-0">Tipo de Usuário</h6>
              <p class="mb-0">
                {% if user.is_staff or user.is_superuser %}
                  <span class="badge bg-success">Administrador</span>
                {% else %}
                  <span class="badge bg-info">Visitante/Aluno</span>
                {% endif %}
              </p>
            </div>
          </div>
          
          {% if not user.is_staff and not user.is_superuser %}
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Acesso básico:</strong> Você pode navegar pelo site e ver conteúdos públicos.
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="col-md-6 mb-4">
      <div class="card border-success h-100 shadow-sm">
        <div class="card-header bg-success text-white">
          <h5 class="mb-0"><i class="bi bi-check-circle me-2"></i>O que você pode fazer</h5>
        </div>
        <div class="card-body">
          <ul class="list-group list-group-flush">
            <li class="list-group-item border-0 px-0">
              <i class="bi bi-check text-success me-2"></i>Navegar pelo site e explorar o projeto
            </li>
            <li class="list-group-item border-0 px-0">
              <i class="bi bi-check text-success me-2"></i>Acessar materiais disponíveis
            </li>
            <li class="list-group-item border-0 px-0">
              <i class="bi bi-check text-success me-2"></i>Conhecer a equipe e os objetivos
            </li>
            {% if not user.is_staff and not user.is_superuser %}
            <li class="list-group-item border-0 px-0 text-muted">
              <i class="bi bi-dash-circle me-2"></i>Gerenciar conteúdos e configurações <small class="text-warning">(requer permissão)</small>
            </li>
            {% else %}
            <li class="list-group-item border-0 px-0 fw-bold text-primary">
               <i class="bi bi-check-all me-2"></i>Gerenciar todo o sistema (Admin)
            </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </div>
  </div>

  {% if not user.is_staff and not user.is_superuser %}
  <div class="row mb-4">
    <div class="col-12">
      <div class="card border-warning shadow-sm">
        <div class="card-header bg-warning text-dark">
          <h5 class="mb-0"><i class="bi bi-shield-lock me-2"></i>Precisa de Acesso Administrativo?</h5>
        </div>
        <div class="card-body">
          <p>Se você é <strong>professor ou aluno responsável</strong> por alguma parte do projeto e precisa acessar ferramentas de gestão:</p>
          
          <div class="row">
            <div class="col-md-6">
              <div class="card bg-light mb-3">
                <div class="card-body">
                  <h6><i class="bi bi-1-circle text-primary me-2"></i>Como solicitar:</h6>
                  <ol class="mb-0">
                    <li>Solicite ao administrador atual</li>
                    <li>Aguarde a liberação do acesso</li>
                    <li>Acesse as novas funcionalidades</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>
          
          <div class="alert alert-light mt-3">
            <i class="bi bi-lightbulb text-warning me-2"></i>
            <small>Os botões de páginas administrativas estão visíveis apenas para administradores.</small>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}

{% endblock %}